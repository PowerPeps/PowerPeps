<!DOCTYPE html>
<html x-data="cvApp()" x-init="init()">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CV - Papillon Virton</title>

    <!--
        Language detection & data loading.
        This script runs SYNCHRONOUSLY (no defer/async) so that window.cvLangData
        is set before Alpine.js initialises.
    -->
    <script>
        (function () {
            var params  = new URLSearchParams(window.location.search);
            var stored  = localStorage.getItem('cv-lang');
            var browser = (navigator.language || '').toLowerCase().startsWith('fr') ? 'fr' : 'en';
            var lang    = params.get('lang') || stored || browser;
            if (lang !== 'fr' && lang !== 'en') lang = 'fr';
            localStorage.setItem('cv-lang', lang);
            document.documentElement.lang = lang;
            document.write('<script src="data\/' + lang + '.js"><\/script>');
        })();
    </script>

    <script src="https://cdn.tailwindcss.com"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/@alpinejs/collapse@3.x.x/dist/cdn.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        mono: ['JetBrains Mono', 'monospace'],
                    },
                    colors: {
                        gh: {
                            canvas:  '#0d1117',
                            surface: '#161b22',
                            border:  '#30363d',
                            text:    '#e6edf3',
                            muted:   '#7d8590',
                            accent:  '#58a6ff',
                            green:   '#3fb950',
                            orange:  '#d29922',
                            red:     '#f85149',
                            purple:  '#bc8cff',
                            pink:    '#f778ba',
                            cyan:    '#39d2c0',
                        }
                    }
                }
            }
        }
    </script>

    <style>
        [x-cloak] { display: none !important; }
        body { background: #0d1117; }
        .anim { opacity: 0; transform: translateY(14px); }

        .exp-row { transition: background 0.2s; }
        .exp-row:hover { background: rgba(88,166,255,0.04); }

        .proj-card { transition: border-color 0.2s, background 0.2s; }
        .proj-card:hover { border-color: #58a6ff40; background: #58a6ff08; }

        .tech-badge {
            transition: all 0.2s ease;
            cursor: pointer;
            user-select: none;
        }
        .tech-badge:active { transform: scale(0.95); }

        .gh-cta {
            background: linear-gradient(135deg, #161b22 0%, #1c2333 100%);
            border: 1px solid #30363d;
            transition: all 0.3s ease;
        }
        .gh-cta:hover {
            border-color: #58a6ff60;
            box-shadow: 0 4px 24px rgba(88,166,255,0.08);
            transform: translateY(-1px);
        }

        .lang-btn { transition: color 0.15s, border-color 0.15s; }
    </style>
</head>
<body class="font-sans text-gh-text antialiased">

    <div class="max-w-2xl mx-auto px-5 py-12 md:py-20">

        <!-- HEADER -->
        <header class="mb-8 anim" id="h1">
            <div class="flex items-start justify-between gap-4 mb-2">
                <h1 class="text-3xl md:text-4xl font-bold tracking-tight leading-tight">Papillon Virton</h1>

                <!-- Language switcher -->
                <div class="flex items-center gap-1.5 shrink-0 pt-1">
                    <button @click="switchLang('fr')"
                            :class="lang === 'fr' ? 'text-gh-accent border-gh-accent/50' : 'text-gh-muted border-gh-border hover:text-gh-text'"
                            class="lang-btn font-mono text-[10px] px-2 py-0.5 rounded border">
                        FR
                    </button>
                    <button @click="switchLang('en')"
                            :class="lang === 'en' ? 'text-gh-accent border-gh-accent/50' : 'text-gh-muted border-gh-border hover:text-gh-text'"
                            class="lang-btn font-mono text-[10px] px-2 py-0.5 rounded border">
                        EN
                    </button>
                </div>
            </div>

            <div class="h-px bg-gh-border mb-3"></div>
            <div class="flex flex-wrap gap-x-5 gap-y-1 font-mono text-xs text-gh-muted">
                <a href="mailto:papillonvirton.pro@gmail.com" class="hover:text-gh-accent transition-colors">papillonvirton.pro@gmail.com</a>
                <span x-text="labels.location"></span>
                <span x-text="age + ' ans'"></span>
            </div>
        </header>

        <!-- FORMATION / EDUCATION -->
        <section class="mb-8 anim" id="s0">
            <h2 class="font-mono text-[11px] tracking-[0.2em] uppercase text-gh-muted mb-3" x-text="labels.sectionFormation"></h2>
            <div class="space-y-3">
                <template x-for="(f, i) in formation" :key="i">
                    <div class="flex flex-col sm:flex-row sm:gap-4 sm:items-start">
                        <span class="font-mono text-[11px] text-gh-muted sm:w-24 sm:shrink-0 sm:pt-0.5 mb-1 sm:mb-0" x-text="f.date"></span>
                        <div class="flex-1">
                            <div class="flex items-center gap-2 flex-wrap">
                                <p class="font-medium text-sm" x-text="f.title"></p>
                                <span x-show="f.badge"
                                      class="font-mono text-[10px] px-1.5 py-px rounded-full"
                                      :class="f.badgeCls"
                                      x-text="f.badge"></span>
                            </div>
                            <p class="text-xs text-gh-muted mt-0.5" x-text="f.org"></p>
                        </div>
                    </div>
                </template>
            </div>
        </section>

        <!-- EXPERIENCE -->
        <section class="mb-8 anim" id="s2">
            <h2 class="font-mono text-[11px] tracking-[0.2em] uppercase text-gh-muted mb-3" x-text="labels.sectionExp"></h2>
            <div class="space-y-px rounded-lg border border-gh-border overflow-hidden bg-gh-surface">

                <template x-for="(e, i) in exps" :key="i">
                    <div class="exp-row px-3.5 py-2.5 cursor-pointer border-b border-gh-border last:border-0"
                         @click="open = open === i ? null : i">
                        <div class="flex flex-col sm:flex-row sm:items-start sm:gap-3.5">
                            <span class="font-mono text-[11px] text-gh-muted sm:w-24 sm:shrink-0 sm:pt-0.5 mb-1.5 sm:mb-0" x-text="e.date"></span>
                            <div class="flex-1 min-w-0">
                                <div class="flex items-center justify-between gap-2">
                                    <div class="flex items-center gap-2 flex-wrap min-w-0">
                                        <p class="font-medium text-sm truncate" x-text="e.title"></p>
                                        <span class="font-mono text-[10px] px-1.5 py-px rounded-full shrink-0"
                                              :class="e.badgeCls"
                                              x-text="e.badge"></span>
                                    </div>
                                    <svg class="w-3.5 h-3.5 text-gh-muted shrink-0 transition-transform duration-200"
                                         :class="open === i && 'rotate-180'"
                                         fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                                    </svg>
                                </div>
                                <div x-show="open === i" x-collapse x-cloak>
                                    <p class="text-xs text-gh-muted mt-1.5 leading-relaxed" x-text="e.desc"></p>
                                    <div x-show="e.tags && e.tags.length" class="flex flex-wrap gap-1.5 mt-2">
                                        <template x-for="tag in (e.tags || [])" :key="tag.t">
                                            <span class="px-1.5 py-px rounded text-[10px] font-mono border"
                                                  :class="tag.c"
                                                  x-text="tag.t"></span>
                                        </template>
                                    </div>
                                    <a x-show="e.url" :href="e.url" target="_blank" rel="noopener"
                                       class="inline-flex items-center gap-1 text-[11px] text-gh-accent mt-2 hover:underline font-mono">
                                        <span x-text="e.linkText || labels.learnMore"></span>
                                        <svg class="w-3 h-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/></svg>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </template>

            </div>
        </section>

        <!-- PROJECTS -->
        <section class="mb-8 anim" id="s3">
            <h2 class="font-mono text-[11px] tracking-[0.2em] uppercase text-gh-muted mb-3" x-text="labels.sectionProjects"></h2>

            <a href="https://github.com/PowerPeps" target="_blank" class="gh-cta rounded-lg p-3.5 mb-3 flex items-center gap-3.5 group block">
                <svg class="w-7 h-7 text-gh-muted group-hover:text-gh-text shrink-0 transition-colors" viewBox="0 0 24 24" fill="currentColor"><path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/></svg>
                <div class="flex-1 min-w-0">
                    <p class="font-medium text-sm text-gh-text" x-text="labels.githubHandle"></p>
                    <p class="text-[11px] text-gh-muted mt-px" x-text="labels.githubDesc"></p>
                </div>
                <svg class="w-4 h-4 text-gh-muted group-hover:text-gh-accent group-hover:translate-x-0.5 shrink-0 transition-all" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/></svg>
            </a>

            <div class="space-y-2">
                <template x-for="(p, i) in projects" :key="i">
                    <div class="proj-card border border-gh-border rounded-lg px-3.5 py-2.5 cursor-pointer bg-gh-surface"
                         @click="projOpen = projOpen === i ? null : i">
                        <div class="flex items-center justify-between gap-2">
                            <div class="flex items-center gap-2 flex-wrap min-w-0">
                                <p class="font-medium text-sm text-gh-accent" x-text="p.name"></p>
                                <span class="font-mono text-[10px] px-1.5 py-px rounded-full shrink-0"
                                      :class="p.badgeCls"
                                      x-text="p.badge"></span>
                            </div>
                            <svg class="w-3.5 h-3.5 text-gh-muted shrink-0 transition-transform duration-200"
                                 :class="projOpen === i && 'rotate-180'"
                                 fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"/>
                            </svg>
                        </div>
                        <p class="text-[11px] text-gh-muted mt-0.5" x-text="p.short"></p>
                        <div x-show="projOpen === i" x-collapse x-cloak>
                            <p class="text-xs text-gh-muted mt-2 leading-relaxed" x-text="p.desc"></p>
                            <div x-show="p.tags && p.tags.length" class="flex flex-wrap gap-1.5 mt-2">
                                <template x-for="tag in (p.tags || [])" :key="tag.t">
                                    <span class="px-1.5 py-px rounded text-[10px] font-mono border"
                                          :class="tag.c"
                                          x-text="tag.t"></span>
                                </template>
                            </div>
                            <a x-show="p.url" :href="p.url" target="_blank" rel="noopener"
                               class="inline-flex items-center gap-1 text-[11px] text-gh-accent mt-2 hover:underline font-mono">
                                <span x-text="labels.viewOnGithub"></span>
                                <svg class="w-3 h-3" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"/></svg>
                            </a>
                        </div>
                    </div>
                </template>
            </div>
        </section>

        <!-- PASSIONS / INTERESTS -->
        <section class="mb-8 anim" id="s4">
            <h2 class="font-mono text-[11px] tracking-[0.2em] uppercase text-gh-muted mb-3" x-text="labels.sectionPassions"></h2>
            <div class="flex flex-wrap gap-1.5">
                <template x-for="p in passions" :key="p">
                    <span class="px-2 py-0.5 rounded-md text-xs border border-gh-border text-gh-muted" x-text="p"></span>
                </template>
            </div>
        </section>

        <div class="h-px bg-gh-border anim" id="s5"></div>
        <p class="font-mono text-[10px] text-gh-muted/40 mt-2.5 text-center anim" id="s6" x-text="labels.location"></p>

    </div>

    <script>
        function cvApp() {
            return {
                open:      null,
                projOpen:  null,
                age:       0,
                lang:      'fr',
                labels:    {},
                formation: [],
                exps:      [],
                projects:  [],
                passions:  [],

                init() {
                    // Merge data loaded by the synchronous <script> tag above
                    const d = window.cvLangData || {};
                    this.lang      = d.lang      || 'fr';
                    this.labels    = d.labels    || {};
                    this.formation = d.formation || [];
                    this.exps      = d.exps      || [];
                    this.projects  = d.projects  || [];
                    this.passions  = d.passions  || [];

                    this.age = new Date(Date.now() - new Date(2003, 3, 22)).getUTCFullYear() - 1970;

                    // Animate sections once Alpine has rendered the DOM
                    this.$nextTick(() => this._animate());
                },

                switchLang(newLang) {
                    if (newLang === this.lang) return;
                    localStorage.setItem('cv-lang', newLang);
                    const url = new URL(window.location.href);
                    url.searchParams.set('lang', newLang);
                    window.location.href = url.toString();
                },

                _animate() {
                    const tl = gsap.timeline({ defaults: { ease: 'power2.out', duration: 0.5 } });
                    tl.to('#h1', { opacity: 1, y: 0 }, 0.10)
                      .to('#s0', { opacity: 1, y: 0 }, 0.18)
                      .to('#s2', { opacity: 1, y: 0 }, 0.26)
                      .to('#s3', { opacity: 1, y: 0 }, 0.34)
                      .to('#s4', { opacity: 1, y: 0 }, 0.42)
                      .to('#s5', { opacity: 1, y: 0 }, 0.48)
                      .to('#s6', { opacity: 1, y: 0 }, 0.52);
                },
            };
        }
    </script>
</body>
</html>